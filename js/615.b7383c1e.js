(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[615],{5787:function(t,e,i){var s=i(7976),r=TypeError;t.exports=function(t,e){if(s(e,t))return t;throw r("Incorrect invocation")}},3678:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},1060:function(t,e,i){var s=i(1702),r=Error,o=s("".replace),a=function(t){return String(r(t).stack)}("zxcasd"),h=/\n\s*at [^:]*:[^\n]*/,n=h.test(a);t.exports=function(t,e){if(n&&"string"==typeof t&&!r.prepareStackTrace)while(e--)t=o(t,h,"");return t}},9587:function(t,e,i){var s=i(614),r=i(111),o=i(7674);t.exports=function(t,e,i){var a,h;return o&&s(a=e.constructor)&&a!==i&&r(h=a.prototype)&&h!==i.prototype&&o(t,h),t}},6277:function(t,e,i){var s=i(1340);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:s(t)}},1340:function(t,e,i){var s=i(648),r=String;t.exports=function(t){if("Symbol"===s(t))throw TypeError("Cannot convert a Symbol value to a string");return r(t)}},2801:function(t,e,i){"use strict";var s=i(2109),r=i(7854),o=i(5005),a=i(9114),h=i(3070).f,n=i(2597),l=i(5787),c=i(9587),d=i(6277),u=i(3678),m=i(1060),g=i(9781),f=i(1913),y="DOMException",p=o("Error"),w=o(y),x=function(){l(this,k);var t=arguments.length,e=d(t<1?void 0:arguments[0]),i=d(t<2?void 0:arguments[1],"Error"),s=new w(e,i),r=p(e);return r.name=y,h(s,"stack",a(1,m(r.stack,1))),c(s,this,x),s},k=x.prototype=w.prototype,S="stack"in p(y),E="stack"in new w(1,2),I=w&&g&&Object.getOwnPropertyDescriptor(r,y),v=!!I&&!(I.writable&&I.configurable),R=S&&!v&&!E;s({global:!0,constructor:!0,forced:f||R},{DOMException:R?x:w});var b=o(y),N=b.prototype;if(N.constructor!==b)for(var T in f||h(N,"constructor",a(1,b)),u)if(n(u,T)){var D=u[T],A=D.s;n(b,A)||h(b,A,a(6,D.c))}},1576:function(t,e,i){"use strict";i.d(e,{Z:function(){return o}});i(7658);var s=i(3396),r=!1;var o=(0,s.aZ)({name:"VueDrawingCanvas",props:{strokeType:{type:String,validator:t=>-1!==["dash","line","square","circle","triangle","half_triangle"].indexOf(t),default:()=>"dash"},fillShape:{type:Boolean,default:()=>!1},width:{type:[String,Number],default:()=>600},height:{type:[String,Number],default:()=>400},image:{type:String,default:()=>""},eraser:{type:Boolean,default:()=>!1},color:{type:String,default:()=>"#000000"},lineWidth:{type:Number,default:()=>5},lineCap:{type:String,validator:t=>-1!==["round","square","butt"].indexOf(t),default:()=>"round"},lineJoin:{type:String,validator:t=>-1!==["miter","round","bevel"].indexOf(t),default:()=>"miter"},lock:{type:Boolean,default:()=>!1},styles:{type:[Array,String,Object]},classes:{type:[Array,String,Object]},backgroundColor:{type:String,default:()=>"#FFFFFF"},backgroundImage:{type:String,default:()=>null},watermark:{type:Object,default:()=>null},saveAs:{type:String,validator:t=>-1!==["jpeg","png"].indexOf(t),default:()=>"png"},canvasId:{type:String,default:()=>"VueDrawingCanvas"},initialImage:{type:Array,default:()=>[]},additionalImages:{type:Array,default:()=>[]},outputWidth:{type:Number},outputHeight:{type:Number}},data(){return{loadedImage:null,drawing:!1,context:null,images:[],strokes:{type:"",from:{x:0,y:0},coordinates:[],color:"",width:"",fill:!1,lineCap:"",lineJoin:""},guides:[],trash:[]}},mounted(){this.setContext(),this.$nextTick((()=>{this.drawInitialImage(),this.drawAdditionalImages()}))},watch:{backgroundImage:function(){this.loadedImage=null}},methods:{async setContext(){let t=document.querySelector("#"+this.canvasId);this.context=this.context?this.context:t.getContext("2d"),await this.setBackground()},drawInitialImage(){this.initialImage&&this.initialImage.length>0&&(this.images=[].concat(this.images,this.initialImage),this.redraw(!0))},drawAdditionalImages(){if(this.additionalImages&&this.additionalImages.length>0){let t=document.querySelector("#"+this.canvasId);this.additionalImages.forEach((e=>{this.drawWatermark(t,this.context,e)}))}},clear(){this.context.clearRect(0,0,Number(this.width),Number(this.height))},async setBackground(){this.clear(),this.context.fillStyle=this.backgroundColor,this.context.fillRect(0,0,Number(this.width),Number(this.height)),await this.$nextTick((async()=>{await this.drawBackgroundImage()})),this.save()},async drawBackgroundImage(){if(!this.loadedImage)return new Promise((t=>{if(!this.backgroundImage)return void t();const e=new Image;e.src=this.backgroundImage,e.onload=()=>{this.context.drawImage(e,0,0,Number(this.width),Number(this.height)),this.loadedImage=e,t()}}));this.context.drawImage(this.loadedImage,0,0,Number(this.width),Number(this.height))},getCoordinates(t){let e,i;if(t.touches&&t.touches.length>0){let s=document.querySelector("#"+this.canvasId),r=s.getBoundingClientRect();e=t.touches[0].clientX-r.left,i=t.touches[0].clientY-r.top}else e=t.offsetX,i=t.offsetY;return{x:e,y:i}},startDraw(t){if(!this.lock){this.drawing=!0;let e=this.getCoordinates(t);this.strokes={type:this.eraser?"eraser":this.strokeType,from:e,coordinates:[],color:this.eraser?this.backgroundColor:this.color,width:this.lineWidth,fill:!this.eraser&&"dash"!==this.strokeType&&"line"!==this.strokeType&&this.fillShape,lineCap:this.lineCap,lineJoin:this.lineJoin},this.guides=[]}},draw(t){if(this.drawing){this.context||this.setContext();let e=this.getCoordinates(t);if(this.eraser||"dash"===this.strokeType)this.strokes.coordinates.push(e),this.drawShape(this.context,this.strokes,!1);else{switch(this.strokeType){case"line":this.guides=[{x:e.x,y:e.y}];break;case"square":this.guides=[{x:e.x,y:this.strokes.from.y},{x:e.x,y:e.y},{x:this.strokes.from.x,y:e.y},{x:this.strokes.from.x,y:this.strokes.from.y}];break;case"triangle":let t=Math.floor((e.x-this.strokes.from.x)/2)<0?-1*Math.floor((e.x-this.strokes.from.x)/2):Math.floor((e.x-this.strokes.from.x)/2),i=this.strokes.from.x<e.x?this.strokes.from.x+t:this.strokes.from.x-t;this.guides=[{x:e.x,y:this.strokes.from.y},{x:i,y:e.y},{x:this.strokes.from.x,y:this.strokes.from.y}];break;case"half_triangle":this.guides=[{x:e.x,y:this.strokes.from.y},{x:this.strokes.from.x,y:e.y},{x:this.strokes.from.x,y:this.strokes.from.y}];break;case"circle":let s=this.strokes.from.x-e.x<0?-1*(this.strokes.from.x-e.x):this.strokes.from.x-e.x;this.guides=[{x:this.strokes.from.x>e.x?this.strokes.from.x-s:this.strokes.from.x+s,y:this.strokes.from.y},{x:s,y:s}];break}this.drawGuide(!0)}}},drawGuide(t){this.redraw(!0),this.$nextTick((()=>{this.context.strokeStyle=this.color,this.context.lineWidth=1,this.context.lineJoin=this.lineJoin,this.context.lineCap=this.lineCap,this.context.beginPath(),this.context.setLineDash([15,15]),"circle"===this.strokes.type?this.context.ellipse(this.guides[0].x,this.guides[0].y,this.guides[1].x,this.guides[1].y,0,0,2*Math.PI):(this.context.moveTo(this.strokes.from.x,this.strokes.from.y),this.guides.forEach((t=>{this.context.lineTo(t.x,t.y)})),t&&this.context.closePath()),this.context.stroke()}))},drawShape(t,e,i){t.strokeStyle=e.color,t.fillStyle=e.color,t.lineWidth=e.width,t.lineJoin=void 0===e.lineJoin?this.lineJoin:e.lineJoin,t.lineCap=void 0===e.lineCap?this.lineCap:e.lineCap,t.beginPath(),t.setLineDash([]),"circle"===e.type?t.ellipse(e.coordinates[0].x,e.coordinates[0].y,e.coordinates[1].x,e.coordinates[1].y,0,0,2*Math.PI):(t.moveTo(e.from.x,e.from.y),e.coordinates.forEach((e=>{t.lineTo(e.x,e.y)})),i&&t.closePath()),e.fill?t.fill():t.stroke()},stopDraw(){this.drawing&&(this.strokes.coordinates=this.guides.length>0?this.guides:this.strokes.coordinates,this.images.push(this.strokes),this.redraw(!0),this.drawing=!1,this.trash=[])},reset(){this.lock||(this.images=[],this.strokes={type:"",coordinates:[],color:"",width:"",fill:!1,lineCap:"",lineJoin:""},this.guides=[],this.trash=[],this.redraw(!0))},undo(){if(!this.lock){let t=this.images.pop();t&&(this.trash.push(t),this.redraw(!0))}},redo(){if(!this.lock){let t=this.trash.pop();t&&(this.images.push(t),this.redraw(!0))}},async redraw(t){t="undefined"===typeof t||t,await this.setBackground().then((()=>{this.drawAdditionalImages()})).then((()=>{let t=document.createElement("canvas"),e=t.getContext("2d");t.width=Number(this.width),t.height=Number(this.height),e&&(this.images.forEach((t=>{e&&(e.globalCompositeOperation="eraser"===t.type?"destination-out":"source-over",("circle"!==t.type||"circle"===t.type&&t.coordinates.length>0)&&this.drawShape(e,t,"eraser"!==t.type&&"dash"!==t.type&&"line"!==t.type))})),this.context.drawImage(t,0,0,Number(this.width),Number(this.height)))})).then((()=>{t&&this.save()}))},wrapText(t,e,i,s,r,o){const a=/(\r\n|\n\r|\n|\r)+/g,h=/\s+/g;var n=e.split(a).filter((t=>t.length>0));for(let f=0;f<n.length;f++){for(var l=n[f].split(h).filter((t=>t.length>0)),c="",d=0;d<l.length;d++){var u=c+l[d]+" ",m=t.measureText(u),g=m.width;g>r&&d>0?(this.watermark&&this.watermark.fontStyle&&this.watermark.fontStyle.drawType&&"stroke"===this.watermark.fontStyle.drawType?t.strokeText(c,i,s):t.fillText(c,i,s),c=l[d]+" ",s+=o):c=u}this.watermark&&this.watermark.fontStyle&&this.watermark.fontStyle.drawType&&"stroke"===this.watermark.fontStyle.drawType?t.strokeText(c,i,s):t.fillText(c,i,s),s+=l.length>0?o:0}},save(){let t=document.querySelector("#"+this.canvasId);if(this.watermark){let e=document.createElement("canvas"),i=e.getContext("2d");i&&(e.width=Number(this.width),e.height=Number(this.height),i.drawImage(t,0,0,Number(this.width),Number(this.height)),this.drawWatermark(e,i,this.watermark))}else{let e=document.createElement("canvas"),i=e.getContext("2d"),s=void 0===this.outputWidth?this.width:this.outputWidth,r=void 0===this.outputHeight?this.height:this.outputHeight;if(e.width=Number(s),e.height=Number(r),i)return i.drawImage(t,0,0,Number(s),Number(r)),this.$emit("update:image",e.toDataURL("image/"+this.saveAs,1)),e.toDataURL("image/"+this.saveAs,1)}},drawWatermark(t,e,i){if("Image"===i.type){let s=i.imageStyle&&i.imageStyle.width?i.imageStyle.width:Number(this.width),r=i.imageStyle&&i.imageStyle.height?i.imageStyle.height:Number(this.height);const o=new Image;o.src=i.source,o.onload=()=>{i&&e&&e.drawImage(o,i.x,i.y,Number(s),Number(r));let a=document.createElement("canvas"),h=a.getContext("2d"),n=void 0===this.outputWidth?this.width:this.outputWidth,l=void 0===this.outputHeight?this.height:this.outputHeight;if(a.width=Number(n),a.height=Number(l),h)return h.drawImage(t,0,0,Number(n),Number(l)),this.$emit("update:image",a.toDataURL("image/"+this.saveAs,1)),a.toDataURL("image/"+this.saveAs,1)}}else if("Text"===i.type){let s=i.fontStyle&&i.fontStyle.font?i.fontStyle.font:"20px serif",r=i.fontStyle&&i.fontStyle.textAlign?i.fontStyle.textAlign:"start",o=i.fontStyle&&i.fontStyle.textBaseline?i.fontStyle.textBaseline:"alphabetic",a=i.fontStyle&&i.fontStyle.color?i.fontStyle.color:"#000000";if(e.font=s,e.textAlign=r,e.textBaseline=o,i.fontStyle&&i.fontStyle.rotate){let t,s;t=i.fontStyle&&i.fontStyle.width?i.x+Math.floor(i.fontStyle.width/2):i.x,s=i.fontStyle&&i.fontStyle.lineHeight?i.y+Math.floor(i.fontStyle.lineHeight/2):i.y,e.translate(t,s),e.rotate(i.fontStyle.rotate*Math.PI/180),e.translate(-1*t,-1*s)}i.fontStyle&&i.fontStyle.drawType&&"stroke"===i.fontStyle.drawType?(e.strokeStyle=i.fontStyle.color,i.fontStyle&&i.fontStyle.width?this.wrapText(e,i.source,i.x,i.y,i.fontStyle.width,i.fontStyle.lineHeight):e.strokeText(i.source,i.x,i.y)):(e.fillStyle=a,i.fontStyle&&i.fontStyle.width?this.wrapText(e,i.source,i.x,i.y,i.fontStyle.width,i.fontStyle.lineHeight):e.fillText(i.source,i.x,i.y));let h=document.createElement("canvas"),n=h.getContext("2d"),l=void 0===this.outputWidth?this.width:this.outputWidth,c=void 0===this.outputHeight?this.height:this.outputHeight;if(h.width=Number(l),h.height=Number(c),n)return n.drawImage(t,0,0,Number(l),Number(c)),this.$emit("update:image",h.toDataURL("image/"+this.saveAs,1)),h.toDataURL("image/"+this.saveAs,1)}},isEmpty(){return!(this.images.length>0)},getAllStrokes(){return this.images}},render(){return r?(0,s.h)("canvas",{attrs:{id:this.canvasId,width:Number(this.width),height:Number(this.height)},style:{touchAction:"none",...this.styles},class:this.classes,on:{mousedown:t=>this.startDraw(t),mousemove:t=>this.draw(t),mouseup:()=>this.stopDraw(),mouseleave:()=>this.stopDraw(),touchstart:t=>this.startDraw(t),touchmove:t=>this.draw(t),touchend:()=>this.stopDraw(),touchleave:()=>this.stopDraw(),touchcancel:()=>this.stopDraw(),pointerdown:t=>this.startDraw(t),pointermove:t=>this.draw(t),pointerup:()=>this.stopDraw(),pointerleave:()=>this.stopDraw(),pointercancel:()=>this.stopDraw()},...this.$props}):(0,s.h)("canvas",{id:this.canvasId,height:Number(this.height),width:Number(this.width),style:{touchAction:"none",...this.styles},class:this.classes,onMousedown:t=>this.startDraw(t),onMousemove:t=>this.draw(t),onMouseup:()=>this.stopDraw(),onMouseleave:()=>this.stopDraw(),onTouchstart:t=>this.startDraw(t),onTouchmove:t=>this.draw(t),onTouchend:()=>this.stopDraw(),onTouchleave:()=>this.stopDraw(),onTouchcancel:()=>this.stopDraw(),onPointerdown:t=>this.startDraw(t),onPointermove:t=>this.draw(t),onPointerup:()=>this.stopDraw(),onPointerleave:()=>this.stopDraw(),onPointercancel:()=>this.stopDraw()})}})}}]);
//# sourceMappingURL=615.b7383c1e.js.map